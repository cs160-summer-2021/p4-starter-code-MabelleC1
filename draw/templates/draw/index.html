{% load static %}

<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  	<title>CurrP4 Coloring</title>
    <style></style>
    <link rel="stylesheet" type="text/css" href="{% static 'draw/vendor/bootstrap/css/bootstrap.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'draw/vendor/css/style.css' %}">
    <script type="text/javascript" src="{% static 'draw/vendor/jquery/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'draw/vendor/paper/paper-full.min.js' %}"></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&display=swap" rel="stylesheet">
  
</head>
<body>
	<div class="content-holder">
		<div id = "largeScreen" class="large-display">
			<div class="top-info">
				<div id="library-name">
					<h1>Dima Library</h1>
					<h4>UC Berkeley</h4>
				</div>
				<div id="library-floor">
					Ground floor
				</div>
			</div>
			<svg width="1049" height="457" viewBox="0 0 1049 457" fill="none" xmlns="http://www.w3.org/2000/svg">
				<rect id="RoomA" x="75" y="62" width="230" height="100" fill="white" fill-opacity="0.3" stroke="#D5DEE4" stroke-width="6" stroke-linejoin="round"/>
				<rect id="RoomB" x="47" y="162" width="286" height="292" fill="white" fill-opacity="0.3" stroke="#D5DEE4" stroke-width="6" stroke-linejoin="round"/>
				<rect id="RoomC" x="333" y="244" width="148" height="210" fill="white" fill-opacity="0.3" stroke="#D5DEE4" stroke-width="6" stroke-linejoin="round"/>
				<rect id="RoomD" x="481" y="109" width="305" height="345" fill="white" fill-opacity="0.3" stroke="#D5DEE4" stroke-width="6" stroke-linejoin="round"/>
				<rect id="RoomE" x="786" y="257" width="260" height="197" fill="white" fill-opacity="0.3" stroke="#D5DEE4" stroke-width="6" stroke-linejoin="round"/>
				<rect id="A1" x="102" y="84" width="48" height="56" fill="#DDF0F8" stroke="#B8E5F3" stroke-width="4" stroke-linejoin="round"/>
				<rect id="A2" x="166" y="84" width="48" height="56" fill="#DDF0F8" stroke="#B8E5F3" stroke-width="4" stroke-linejoin="round"/>
				<rect id="A3" x="230" y="84" width="48" height="56" fill="#B8E5F3" stroke="#7BD3EB" stroke-width="4" stroke-linejoin="round"/>
				<rect id="B1" x="104" y="220" width="80" height="80" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="B2" x="196" y="220" width="80" height="80" fill="#7BD3EB" stroke="#21BADF" stroke-width="4" stroke-linejoin="round"/>
				<rect id="B3" x="104" y="312" width="80" height="80" fill="#7BD3EB" stroke="#21BADF" stroke-width="4" stroke-linejoin="round"/>
				<rect id="B4" x="196" y="312" width="80" height="80" fill="#DDF0F8" stroke="#B8E5F3" stroke-width="4" stroke-linejoin="round"/>
				<rect id="C1" x="370" y="265" width="75" height="45" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="C2" x="370" y="326" width="75" height="45" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="C3" x="370" y="387" width="75" height="45" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="D1" x="532" y="135" width="203" height="55" fill="#7BD3EB" stroke="#21BADF" stroke-width="4" stroke-linejoin="round"/>
				<rect id="D2" x="532" y="214" width="203" height="55" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="D3" x="532" y="293" width="203" height="55" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="D4" x="532" y="372" width="203" height="55" fill="#21BADF" stroke="#00A6CE" stroke-width="4" stroke-linejoin="round"/>
				<rect id="E1" x="863" y="296" width="106" height="123" fill="#7BD3EB" stroke="#21BADF" stroke-width="4" stroke-linejoin="round"/>
				<g filter="url(#filter0_d)">
				<rect x="32" y="34" width="56" height="56" rx="6.89231" fill="#EA5B62"/>
				<path d="M64.9277 68.041H55.0137L52.9395 74H48.3164L57.9844 48.4062H61.9746L71.6602 74H67.0195L64.9277 68.041ZM56.2617 64.4551H63.6797L59.9707 53.8379L56.2617 64.4551Z" fill="white"/>
				<circle id="CircleA" cx="85" cy="37" r="17" fill="#94D75F"/>
				<path d="M84 30L79 34H75V40H79L84 44V30Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="ALine1" d="M88.54 33.46C89.4774 34.3976 90.004 35.6692 90.004 36.995C90.004 38.3208 89.4774 39.5924 88.54 40.53" stroke="0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="ALine2" d="M92.0701 29.93C93.9448 31.8053 94.9979 34.3484 94.9979 37C94.9979 39.6516 93.9448 42.1947 92.0701 44.07" stroke="0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</g>
				<g filter="url(#filter1_d)">
				<rect x="20" y="371" width="55" height="56" rx="6.89231" fill="#EA5B62"/>
				<path d="M38.6016 411V385.406H47.373C50.2676 385.406 52.4707 385.986 53.9824 387.146C55.4941 388.307 56.25 390.035 56.25 392.332C56.25 393.504 55.9336 394.559 55.3008 395.496C54.668 396.434 53.7422 397.16 52.5234 397.676C53.9062 398.051 54.9727 398.76 55.7227 399.803C56.4844 400.834 56.8652 402.076 56.8652 403.529C56.8652 405.932 56.0918 407.777 54.5449 409.066C53.0098 410.355 50.8066 411 47.9355 411H38.6016ZM43.0488 399.451V407.449H47.9883C49.3828 407.449 50.4727 407.104 51.2578 406.412C52.043 405.721 52.4355 404.76 52.4355 403.529C52.4355 400.869 51.0762 399.51 48.3574 399.451H43.0488ZM43.0488 396.182H47.4082C48.791 396.182 49.8691 395.871 50.6426 395.25C51.4277 394.617 51.8203 393.727 51.8203 392.578C51.8203 391.312 51.457 390.398 50.7305 389.836C50.0156 389.273 48.8965 388.992 47.373 388.992H43.0488V396.182Z" fill="white"/>
				<circle id="CircleB" cx="72" cy="375" r="17" fill="#FFAA47"/>
				<path d="M71 368L66 372H62V378H66L71 382V368Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="BLine1" d="M75.54 371.46C76.4774 372.398 77.004 373.669 77.004 374.995C77.004 376.321 76.4774 377.592 75.54 378.53" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="BLine2" d="M79.0701 367.93C80.9448 369.805 81.9979 372.348 81.9979 375C81.9979 377.652 80.9448 380.195 79.0701 382.07" stroke="0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</g>
				<g filter="url(#filter2_d)">
				<rect x="345" y="201" width="56" height="56" rx="6.89231" fill="#EA5B62"/>
				<path d="M383.131 232.668C382.873 235.398 381.865 237.531 380.107 239.066C378.35 240.59 376.012 241.352 373.094 241.352C371.055 241.352 369.256 240.871 367.697 239.91C366.15 238.938 364.955 237.561 364.111 235.779C363.268 233.998 362.828 231.93 362.793 229.574V227.184C362.793 224.77 363.221 222.643 364.076 220.803C364.932 218.963 366.156 217.545 367.75 216.549C369.355 215.553 371.207 215.055 373.305 215.055C376.129 215.055 378.402 215.822 380.125 217.357C381.848 218.893 382.85 221.061 383.131 223.861H378.701C378.49 222.021 377.951 220.697 377.084 219.889C376.229 219.068 374.969 218.658 373.305 218.658C371.371 218.658 369.883 219.367 368.84 220.785C367.809 222.191 367.281 224.26 367.258 226.99V229.258C367.258 232.023 367.75 234.133 368.734 235.586C369.73 237.039 371.184 237.766 373.094 237.766C374.84 237.766 376.152 237.373 377.031 236.588C377.91 235.803 378.467 234.496 378.701 232.668H383.131Z" fill="white"/>
				<circle id="CircleC" cx="398" cy="204" r="17" fill="#D55151"/>
				<path d="M397 197L392 201H388V207H392L397 211V197Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="CLine1" d="M401.54 200.46C402.477 201.398 403.004 202.669 403.004 203.995C403.004 205.321 402.477 206.592 401.54 207.53" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="CLine2" d="M405.07 196.93C406.945 198.805 407.998 201.348 407.998 204C407.998 206.652 406.945 209.195 405.07 211.07" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</g>
				<g filter="url(#filter3_d)">
				<rect x="495" y="73" width="56" height="56" rx="6.89231" fill="#EA5B62"/>
				<path d="M513.602 113V87.4062H521.16C523.422 87.4062 525.426 87.9102 527.172 88.918C528.93 89.9258 530.289 91.3555 531.25 93.207C532.211 95.0586 532.691 97.1797 532.691 99.5703V100.854C532.691 103.279 532.205 105.412 531.232 107.252C530.271 109.092 528.895 110.51 527.102 111.506C525.32 112.502 523.275 113 520.967 113H513.602ZM518.049 90.9922V109.449H520.949C523.281 109.449 525.068 108.723 526.311 107.27C527.564 105.805 528.203 103.707 528.227 100.977V99.5527C528.227 96.7754 527.623 94.6543 526.416 93.1895C525.209 91.7246 523.457 90.9922 521.16 90.9922H518.049Z" fill="white"/>
				<circle id="CircleD" cx="548" cy="76" r="17" fill="#D55151"/>
				<path d="M547 69L542 73H538V79H542L547 83V69Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="DLine1" d="M551.54 72.46C552.477 73.3976 553.004 74.6692 553.004 75.995C553.004 77.3208 552.477 78.5924 551.54 79.53" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="DLine2" d="M555.07 68.93C556.945 70.8053 557.998 73.3484 557.998 76C557.998 78.6516 556.945 81.1947 555.07 83.07" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</g>
				<g filter="url(#filter4_d)">
				<rect x="807" y="225" width="53" height="56" rx="6.89231" fill="#EA5B62"/>
				<path d="M840.561 253.574H830.049V261.449H842.336V265H825.602V239.406H842.213V242.992H830.049V250.059H840.561V253.574Z" fill="white"/>
				<circle id="CircleE" cx="860" cy="228" r="17" fill="#FFAA47"/>
				<path d="M859 221L854 225H850V231H854L859 235V221Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="ELine1" d="M863.54 224.46C864.477 225.398 865.004 226.669 865.004 227.995C865.004 229.321 864.477 230.592 863.54 231.53" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				<path id="ELine2" d="M867.07 220.93C868.945 222.805 869.998 225.348 869.998 228C869.998 230.652 868.945 233.195 867.07 235.07" stroke="0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</g>
				<defs>
				<filter id="filter0_d" x="12" y="0" width="110" height="110" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
				<feFlood flood-opacity="0" result="BackgroundImageFix"/>
				<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
				<feOffset/>
				<feGaussianBlur stdDeviation="10"/>
				<feComposite in2="hardAlpha" operator="out"/>
				<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/>
				<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
				<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
				</filter>
				<filter id="filter1_d" x="0" y="338" width="109" height="109" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
				<feFlood flood-opacity="0" result="BackgroundImageFix"/>
				<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
				<feOffset/>
				<feGaussianBlur stdDeviation="10"/>
				<feComposite in2="hardAlpha" operator="out"/>
				<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/>
				<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
				<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
				</filter>
				<filter id="filter2_d" x="325" y="167" width="110" height="110" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
				<feFlood flood-opacity="0" result="BackgroundImageFix"/>
				<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
				<feOffset/>
				<feGaussianBlur stdDeviation="10"/>
				<feComposite in2="hardAlpha" operator="out"/>
				<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/>
				<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
				<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
				</filter>
				<filter id="filter3_d" x="475" y="39" width="110" height="110" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
				<feFlood flood-opacity="0" result="BackgroundImageFix"/>
				<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
				<feOffset/>
				<feGaussianBlur stdDeviation="10"/>
				<feComposite in2="hardAlpha" operator="out"/>
				<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/>
				<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
				<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
				</filter>
				<filter id="filter4_d" x="787" y="191" width="110" height="110" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
				<feFlood flood-opacity="0" result="BackgroundImageFix"/>
				<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
				<feOffset/>
				<feGaussianBlur stdDeviation="10"/>
				<feComposite in2="hardAlpha" operator="out"/>
				<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/>
				<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
				<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
				</filter>
				</defs>
			</svg>				
			<div id="library-free">
				<h3>Free</h3>
				<div id="colours">
					<div class="colour-block" style="background-color: #DDF0F8;"></div>
					<div class="colour-block" style="background-color: #B8E5F3;"></div>
					<div class="colour-block" style="background-color: #7BD3EB;"></div>
					<div class="colour-block" style="background-color: #21BADF;"></div>
				</div>
				<h3>Busy</h3>
			</div>	
		</div>
		<div id="smallScreen" class="small-display">
			<div id="checkouthide">
				<div id="small-banner">
					<img src="../../static/draw/vendor/images/alert-circle.svg"  style="margin-right: 1rem; width: 4.5vh; height: 4.5vh;">
					<div>Do not close this window!</div>
				</div>
				<div class="welcome-message">
                    <h4 class="welcome">Welcome to</h4>
					<h1 class = "library">Dima Library</h1>
				</div>
                <div class = "col">
                    <div class="wrap">
                        <h1 class="likert-header">Please describe the noise level of the library</h1>
                        <form action="">
                          <label class="statement">1 being quiet to 5 being loud.</label>
                          <ul class='likert'>
                            <li>
                            <input type="radio" onclick = "sendRating(1)" name="likert" value="1">
                              <label>1</label>
                            </li>
                            <li>
                              <input type="radio" onclick = "sendRating(2)" name="likert" value="2">
                              <label>2</label>
                            </li>
                            <li>
                              <input type="radio" onclick = "sendRating(3)" name="likert" value="3">
                              <label>3</label>
                            </li>
                            <li>
                              <input type="radio" onclick = "sendRating(4)" name="likert" value="4">
                              <label>4</label>
                            </li>
                            <li>
                              <input type="radio" onclick = "sendRating(5)" name="likert" value="5">
                              <label>5</label>
                            </li>
                          </ul>
                        </form>
                        <div class="buttons">
                            <button id="submission" onclick = "confirmRating()">Submit</button>
                        </div>
                </div>
				<div id="leavingMess">
					Whenever you're leaving, click below.
				</div>
				<div id="leavingButton">
					<button id="leave-button" onclick="showPopUp()"><img src="../../static/draw/vendor/images/log-out.svg" style="margin-right: 0.4rem; margin-left: 1vh;width:4vh;height:4vh">I'm leaving the library</button>
				</div>
				<div class="popup" id="leavingPopUp"> 
					<div id = "myWords">
						Are you sure you want to check out? 
					</div>
					<div class="col myCol">
						<button onclick="leavingFunction()">Yes</button>
						<button onclick="hidePopUp()">No</button>
					</div>
				</div>
			</div>
		</div>
        <div id="leavingMessage">
            Thanks for checking out! Refresh the page to sign back in or close the window.
        </div>
        
        
		
	</div>
    
		
	<script type="text/javascript" canvas="canvas">

        function showPopUp(){
            var popup = document.getElementById("leavingPopUp");
            popup.style.display = "block";
        }

        function hidePopUp(){
            var popup = document.getElementById("leavingPopUp");
            popup.style.display = "none";
        }

        function showScreen(size) {
            var small = document.getElementById("smallScreen");
            var large = document.getElementById("largeScreen");
            if (size == "small"){
                var leave = document.getElementById("leavingMessage");
                var popup = document.getElementById("leavingPopUp");
                popup.style.display = "none";
                leave.style.display = "none";
                small.style.display = "block";
                large.style.display = "none";
            }
            else{
                small.style.display = "none";
                large.style.display = "block";
            }
        }
        
        function init(){
            const buildingGroupsFirstFloor = new Map();
            buildingGroupsFirstFloor.set('#A1', [1,5]); 
            buildingGroupsFirstFloor.set('#A2', [3,5]);
            buildingGroupsFirstFloor.set('#A3', [2,5]);  
            buildingGroupsFirstFloor.set('#B1', [4,5]);  
            buildingGroupsFirstFloor.set('#B2', [2,5]); 
            buildingGroupsFirstFloor.set('#B3', [1,5]); 
            buildingGroupsFirstFloor.set('#B4', [0,5]); 
            buildingGroupsFirstFloor.set('#C1', [3,5]);  
            buildingGroupsFirstFloor.set('#C2', [4,5]);  
            buildingGroupsFirstFloor.set('#C3', [2,5]); 
            buildingGroupsFirstFloor.set('#D1', [0,5]); 
            buildingGroupsFirstFloor.set('#D2', [2,5]); 
            buildingGroupsFirstFloor.set('#D3', [5,5]); 
            buildingGroupsFirstFloor.set('#D4', [1,5]); 
            buildingGroupsFirstFloor.set('#E1', [5,5]); 

            const buildingGroupsSecondFloor = new Map();
            buildingGroupsSecondFloor.set('#A1', [1,5]); 
            buildingGroupsSecondFloor.set('#A2', [0,5]);  
            buildingGroupsSecondFloor.set('#A3', [0,5]);
            buildingGroupsSecondFloor.set('#B1', [0,5]);  
            buildingGroupsSecondFloor.set('#B2', [0,5]); 
            buildingGroupsSecondFloor.set('#B3', [2,5]); 
            buildingGroupsSecondFloor.set('#B4', [0,5]); 
            buildingGroupsSecondFloor.set('#C1', [3,5]);  
            buildingGroupsSecondFloor.set('#C2', [1,5]);  
            buildingGroupsSecondFloor.set('#C3', [2,5]); 
            buildingGroupsSecondFloor.set('#D1', [0,5]); 
            buildingGroupsSecondFloor.set('#D2', [2,5]); 
            buildingGroupsSecondFloor.set('#D3', [3,5]); 
            buildingGroupsSecondFloor.set('#D4', [1,5]); 
            buildingGroupsSecondFloor.set('#E1', [1,5]); 

            const buildingGroups = [buildingGroupsFirstFloor, buildingGroupsSecondFloor];


            buildingVolume = new Map();
            buildingVolume.set("A", [5]);
            buildingVolume.set("B", [1,2,4]);
            buildingVolume.set("C", [1,2,4]);
            buildingVolume.set("D", [1,2,4]);
            buildingVolume.set("E", [1,2,4]);

            
            var url = window.location.href;
            var queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const size = urlParams.get('size');
            showScreen(size);
            const building = urlParams.get('building');
            const floor = urlParams.get('floor');
            
            return [buildingGroups, size, building, floor, buildingVolume];
        }

        function updateBoxes(buildingGroups){
            for (let [key, value] of buildingGroups){
                var rectbox = document.querySelector(key);
                if (value[0]==value[1]){
                    value[0]= value[0]-0.5;
                }
                var fillColor = fillColorCalc((value[0]/value[1]));//some function that counts how many people are present;
				var strokeColor = strokeColorCalc((value[0]/value[1]));//some function that counts how many people are present;
                rectbox.setAttribute("fill", fillColor);
				rectbox.setAttribute("stroke", strokeColor);
            }
        }

		// Room colour calculations

        function fillColorCalc(percentage) {
			if (percentage <= 0.25) {
				return "#DDF0F8"
			}
			else if (percentage <= 0.5) {
				return "#B8E5F3"
			}
			else if (percentage <= 0.75) {
				return "#7BD3EB"
			}
			else if (percentage <= 1) {
				return "#21BADF"
			}
        }

		function strokeColorCalc(percentage) {
			if (percentage <= 0.25) {
				return "#B8E5F3"
			}
			else if (percentage <= 0.5) {
				return "#7BD3EB"
			}
			else if (percentage <= 0.75) {
				return "#21BADF"
			}
			else if (percentage <= 1) {
				return "#00A6CE"
			}
        }

		var tempRating = -1;

        function sendRating(number){
			tempRating = number;
        }

		function confirmRating(){
			console.log(tempRating);
			if (tempRating > 0){
				buildingGeneral = building.charAt(0);
				const arr = buildingVolume.get(buildingGeneral);
				arr.push(tempRating);
				buildingVolume.set("#"+buildingGeneral, arr);
				socket.send("{\"room\" : " + JSON.stringify(buildingGeneral) + "}");
				tempRating  = -1;
			}
		}

        function setVolume(volume, room){
            const circlewordstr = "#Circle"+room;
            var circleword = document.querySelector(circlewordstr);
            const roomword1str = "#" + room+"Line1";
            console.log("supposed be ALine1 : " + roomword1str)
            var roomword1 = document.querySelector(roomword1str);
            const roomword2str = "#" + room+"Line2";
            var roomword2 = document.querySelector(roomword2str);
            if (volume <= ((1/3)*5)) {
                (circleword).setAttribute("fill", "#94D75F");
                (roomword1).setAttribute("stroke", "0");
                (roomword2).setAttribute("stroke", "0");
            }
            else if (volume <= ((2/3)*5)){
                (circleword).setAttribute("fill", "#FFAA47");
                (roomword1).setAttribute("stroke", "white");
                (roomword2).setAttribute("stroke", "0");
            }else{
                console.log("What is this: "+ circleword);
                (circleword).setAttribute("fill", "#D45151");
                (roomword1).setAttribute("stroke", "white");
                (roomword2).setAttribute("stroke", "white");
            }

        }


        let groupOfObjects = init();
        const buildingGroups = groupOfObjects[0];
        const size = groupOfObjects[1];
        const building = groupOfObjects[2];
        var floor = groupOfObjects[3];
        var buildingVolume = groupOfObjects[4];

        if (!floor){
            floor = 0;
        }
        if (size == "large"){
            updateBoxes(buildingGroups[floor]);
        }

        var socket = new WebSocket('ws://' + window.location.host + '/ws/draw');

		socket.onopen = function(e) {
			console.log("ever here");
			// console.log("building: " + building);
			// console.log("floor: " + floor);
            if (size == "small"){
                socket.send("{\"building\" : " + JSON.stringify(building) + ", \"floor\" : " +  floor + ", \"value\" : " + 1 + "}" );
            }
			socket.onmessage = function(receivedMessage) {
				var received = JSON.parse(receivedMessage.data);
				if (size == "large"){
                    if (!received.room){
                        var strform = "#"+received.building;
                        var updatedvalue = buildingGroups[received.floor].get(strform)[0]+received.value;
                        buildingGroups[received.floor].set(strform, [updatedvalue, buildingGroups[received.floor].get(strform)[1]]);
                        updateBoxes(buildingGroups[received.floor]);
                    }
                    else{
                        var total = 0;
                        var arr =buildingVolume.get(received.room);
                        console.log(arr);
                        for(var i = 0; i < arr.length; i++) {
                            total += arr[i];
                        }
                        var average = total / arr.length;
                        setVolume(average, received.room);
                    }
				}
			// You will probably want to add some code here to draw more lines.
			}
		}
        function leavingFunction(){
            if (size == "small"){
                socket.send("{\"building\" : " + JSON.stringify(building) + ", \"floor\" : " +  floor  + ", \"value\" : " + -1 + "}" );
            }
            var everythingnotleaving = document.getElementById("checkouthide");
            var leave = document.getElementById("leavingMessage");
            if (size == "small"){
                leave.style.display = "block";
                everythingnotleaving.style.display = "none";
            }
        }

    socket.onclose = function(e) {
        console.error('Chat socket closed unexpectedly');
    };
	</script>

</body>
</html>